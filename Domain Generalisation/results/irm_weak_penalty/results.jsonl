{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.11226357535082367, "env0_out_acc": 0.11735941320293398, "env1_in_acc": 0.18976545842217485, "env1_out_acc": 0.21794871794871795, "env2_in_acc": 0.20808383233532934, "env2_out_acc": 0.20958083832335328, "env3_in_acc": 0.089058524173028, "env3_out_acc": 0.1070063694267516, "epoch": 0.0, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 1.982375144958496, "mem_gb": 7.932544231414795, "nll": 1.9803798198699951, "penalty": 0.001995373982936144, "step": 0, "step_time": 0.36846375465393066}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9890176937156803, "env0_out_acc": 0.9633251833740831, "env1_in_acc": 0.9888059701492538, "env1_out_acc": 0.9572649572649573, "env2_in_acc": 0.999251497005988, "env2_out_acc": 0.9910179640718563, "env3_in_acc": 0.7283715012722646, "env3_out_acc": 0.7464968152866241, "epoch": 7.18562874251497, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.27152745009710394, "mem_gb": 8.137436389923096, "nll": 0.25005287628620865, "penalty": 0.021474574324577892, "step": 300, "step_time": 0.09399263302485149}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9701037217815741, "env0_out_acc": 0.9437652811735942, "env1_in_acc": 0.9578891257995735, "env1_out_acc": 0.9102564102564102, "env2_in_acc": 0.9932634730538922, "env2_out_acc": 0.9640718562874252, "env3_in_acc": 0.7318702290076335, "env3_out_acc": 0.7464968152866241, "epoch": 14.37125748502994, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.04010384733323008, "mem_gb": 8.139023303985596, "nll": 0.038640101775527, "penalty": 0.0005616713372910454, "step": 600, "step_time": 0.093777596950531}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9286150091519219, "env0_out_acc": 0.8997555012224939, "env1_in_acc": 0.9008528784648188, "env1_out_acc": 0.8504273504273504, "env2_in_acc": 0.9797904191616766, "env2_out_acc": 0.9760479041916168, "env3_in_acc": 0.6075063613231552, "env3_out_acc": 0.5821656050955414, "epoch": 21.55688622754491, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.18023450570801894, "mem_gb": 8.139023303985596, "nll": 0.14706909257297715, "penalty": 0.0033165412000926153, "step": 900, "step_time": 0.09394712289174398}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9566809029896278, "env0_out_acc": 0.9242053789731052, "env1_in_acc": 0.9674840085287847, "env1_out_acc": 0.9423076923076923, "env2_in_acc": 0.9902694610778443, "env2_out_acc": 0.9491017964071856, "env3_in_acc": 0.7121501272264631, "env3_out_acc": 0.7375796178343949, "epoch": 28.74251497005988, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.14657204640408358, "mem_gb": 8.139023303985596, "nll": 0.1420254308047394, "penalty": 0.0004546615727546547, "step": 1200, "step_time": 0.09393857479095459}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9609517998779744, "env0_out_acc": 0.9144254278728606, "env1_in_acc": 0.9733475479744137, "env1_out_acc": 0.9444444444444444, "env2_in_acc": 0.9940119760479041, "env2_out_acc": 0.9610778443113772, "env3_in_acc": 0.8196564885496184, "env3_out_acc": 0.845859872611465, "epoch": 35.92814371257485, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.10628087648500999, "mem_gb": 8.139023303985596, "nll": 0.09867648295437297, "penalty": 0.0007604393458935495, "step": 1500, "step_time": 0.09403822819391887}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9566809029896278, "env0_out_acc": 0.8997555012224939, "env1_in_acc": 0.976545842217484, "env1_out_acc": 0.9508547008547008, "env2_in_acc": 0.9917664670658682, "env2_out_acc": 0.9520958083832335, "env3_in_acc": 0.763676844783715, "env3_out_acc": 0.8012738853503185, "epoch": 43.11377245508982, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.10585952174539368, "mem_gb": 8.139023303985596, "nll": 0.10070391593811413, "penalty": 0.000515560685841289, "step": 1800, "step_time": 0.09407606681187948}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9792556436851739, "env0_out_acc": 0.9388753056234719, "env1_in_acc": 0.9920042643923241, "env1_out_acc": 0.9572649572649573, "env2_in_acc": 0.999251497005988, "env2_out_acc": 0.9820359281437125, "env3_in_acc": 0.7480916030534351, "env3_out_acc": 0.7834394904458599, "epoch": 50.29940119760479, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.08560693580657244, "mem_gb": 8.139023303985596, "nll": 0.07937157423002646, "penalty": 0.0006235361784517105, "step": 2100, "step_time": 0.09441725969314575}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9816961561928005, "env0_out_acc": 0.941320293398533, "env1_in_acc": 0.9946695095948828, "env1_out_acc": 0.967948717948718, "env2_in_acc": 1.0, "env2_out_acc": 0.9760479041916168, "env3_in_acc": 0.7477735368956743, "env3_out_acc": 0.7910828025477707, "epoch": 57.48502994011976, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.04525931498811891, "mem_gb": 8.139023303985596, "nll": 0.050538359504037844, "penalty": -0.0005279044485219705, "step": 2400, "step_time": 0.09447916587193807}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.987797437461867, "env0_out_acc": 0.941320293398533, "env1_in_acc": 0.9861407249466951, "env1_out_acc": 0.9465811965811965, "env2_in_acc": 0.9940119760479041, "env2_out_acc": 0.9580838323353293, "env3_in_acc": 0.7420483460559797, "env3_out_acc": 0.7503184713375797, "epoch": 64.67065868263474, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.04558313807472587, "mem_gb": 8.139023303985596, "nll": 0.0418087646116813, "penalty": 0.0003774373230483737, "step": 2700, "step_time": 0.09568400939305623}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9835265405735204, "env0_out_acc": 0.9315403422982885, "env1_in_acc": 0.996268656716418, "env1_out_acc": 0.9594017094017094, "env2_in_acc": 0.999251497005988, "env2_out_acc": 0.9730538922155688, "env3_in_acc": 0.696882951653944, "env3_out_acc": 0.7184713375796178, "epoch": 71.8562874251497, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.048966908158424, "mem_gb": 8.139023303985596, "nll": 0.039725361574285974, "penalty": 0.0009241546372807836, "step": 3000, "step_time": 0.0948557432492574}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9969493593654668, "env0_out_acc": 0.9559902200488998, "env1_in_acc": 0.9973347547974414, "env1_out_acc": 0.9636752136752137, "env2_in_acc": 0.999251497005988, "env2_out_acc": 0.9790419161676647, "env3_in_acc": 0.7471374045801527, "env3_out_acc": 0.7694267515923567, "epoch": 79.04191616766467, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.01739943877599823, "mem_gb": 8.139023303985596, "nll": 0.01867256161640398, "penalty": -0.0001273122801194404, "step": 3300, "step_time": 0.0949069078763326}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9975594874923734, "env0_out_acc": 0.9486552567237164, "env1_in_acc": 0.9989339019189766, "env1_out_acc": 0.9700854700854701, "env2_in_acc": 0.9985029940119761, "env2_out_acc": 0.9700598802395209, "env3_in_acc": 0.7767175572519084, "env3_out_acc": 0.7821656050955414, "epoch": 86.22754491017965, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.009617059372152046, "mem_gb": 8.139023303985596, "nll": 0.0089483054849552, "penalty": 6.687537998573134e-05, "step": 3600, "step_time": 0.09569892406463623}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9993898718730934, "env0_out_acc": 0.9535452322738386, "env1_in_acc": 0.9989339019189766, "env1_out_acc": 0.967948717948718, "env2_in_acc": 1.0, "env2_out_acc": 0.9820359281437125, "env3_in_acc": 0.7700381679389313, "env3_out_acc": 0.7834394904458599, "epoch": 93.41317365269461, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.007987335230476067, "mem_gb": 8.139023303985596, "nll": 0.007569034404781026, "penalty": 4.183007997463998e-05, "step": 3900, "step_time": 0.09675801515579224}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9993898718730934, "env0_out_acc": 0.9559902200488998, "env1_in_acc": 1.0, "env1_out_acc": 0.9722222222222222, "env2_in_acc": 1.0, "env2_out_acc": 0.9730538922155688, "env3_in_acc": 0.7818066157760815, "env3_out_acc": 0.8089171974522293, "epoch": 100.59880239520957, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.00421910094495009, "mem_gb": 8.139023303985596, "nll": 0.00415545014635427, "penalty": 6.365078975629028e-06, "step": 4200, "step_time": 0.09470911343892416}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 1.0, "env0_out_acc": 0.9511002444987775, "env1_in_acc": 0.9994669509594882, "env1_out_acc": 0.9615384615384616, "env2_in_acc": 1.0, "env2_out_acc": 0.9850299401197605, "env3_in_acc": 0.7926208651399491, "env3_out_acc": 0.8063694267515924, "epoch": 107.78443113772455, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.003918156107683899, "mem_gb": 8.139023303985596, "nll": 0.003898054812355743, "penalty": 2.010128785817263e-06, "step": 4500, "step_time": 0.09483508825302124}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 1.0, "env0_out_acc": 0.9657701711491442, "env1_in_acc": 0.9994669509594882, "env1_out_acc": 0.9658119658119658, "env2_in_acc": 1.0, "env2_out_acc": 0.9850299401197605, "env3_in_acc": 0.7862595419847328, "env3_out_acc": 0.7885350318471338, "epoch": 114.97005988023952, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.0027809035162742173, "mem_gb": 8.139023303985596, "nll": 0.0026566531045925028, "penalty": 1.2425040847716672e-05, "step": 4800, "step_time": 0.09447109222412109}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 10.0, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9993898718730934, "env0_out_acc": 0.960880195599022, "env1_in_acc": 0.9994669509594882, "env1_out_acc": 0.9700854700854701, "env2_in_acc": 1.0, "env2_out_acc": 0.9730538922155688, "env3_in_acc": 0.7840330788804071, "env3_out_acc": 0.7885350318471338, "epoch": 119.76047904191617, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 10.0, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.0031472953866978058, "mem_gb": 8.139023303985596, "nll": 0.0030488492799122468, "penalty": 9.844609794527059e-06, "step": 5000, "step_time": 0.09595539689064025}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.11226357535082367, "env0_out_acc": 0.11735941320293398, "env1_in_acc": 0.18976545842217485, "env1_out_acc": 0.21794871794871795, "env2_in_acc": 0.20808383233532934, "env2_out_acc": 0.20958083832335328, "env3_in_acc": 0.089058524173028, "env3_out_acc": 0.1070063694267516, "epoch": 0.0, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 1.982375144958496, "mem_gb": 7.932544231414795, "nll": 1.9803798198699951, "penalty": 0.001995373982936144, "step": 0, "step_time": 0.3662877082824707}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9890176937156803, "env0_out_acc": 0.9633251833740831, "env1_in_acc": 0.9888059701492538, "env1_out_acc": 0.9572649572649573, "env2_in_acc": 0.999251497005988, "env2_out_acc": 0.9910179640718563, "env3_in_acc": 0.7283715012722646, "env3_out_acc": 0.7464968152866241, "epoch": 7.18562874251497, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.27152745009710394, "mem_gb": 8.137436389923096, "nll": 0.25005287628620865, "penalty": 0.021474574324577892, "step": 300, "step_time": 0.094168967405955}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.8364856619890177, "env0_out_acc": 0.8019559902200489, "env1_in_acc": 0.7995735607675906, "env1_out_acc": 0.7606837606837606, "env2_in_acc": 0.937125748502994, "env2_out_acc": 0.9041916167664671, "env3_in_acc": 0.6103689567430025, "env3_out_acc": 0.6012738853503184, "epoch": 14.37125748502994, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.4529195653491964, "mem_gb": 8.139023303985596, "nll": 0.08229016776041438, "penalty": 0.004163120598550449, "step": 600, "step_time": 0.09392363945643108}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7211714460036608, "env0_out_acc": 0.726161369193154, "env1_in_acc": 0.7910447761194029, "env1_out_acc": 0.7884615384615384, "env2_in_acc": 0.7986526946107785, "env2_out_acc": 0.7305389221556886, "env3_in_acc": 0.6332697201017812, "env3_out_acc": 0.643312101910828, "epoch": 21.55688622754491, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -13.96678027878205, "mem_gb": 8.139023303985596, "nll": 1.418085314631462, "penalty": -0.15384865674631631, "step": 900, "step_time": 0.09411057074864705}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.5216595485051861, "env0_out_acc": 0.5501222493887531, "env1_in_acc": 0.8363539445628998, "env1_out_acc": 0.8012820512820513, "env2_in_acc": 0.47380239520958084, "env2_out_acc": 0.5, "env3_in_acc": 0.48759541984732824, "env3_out_acc": 0.45222929936305734, "epoch": 28.74251497005988, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -56.683046867847445, "mem_gb": 8.139023303985596, "nll": 2.247739404439926, "penalty": -0.5893078695941949, "step": 1200, "step_time": 0.09413227558135986}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.5454545454545454, "env0_out_acc": 0.5745721271393643, "env1_in_acc": 0.8256929637526652, "env1_out_acc": 0.8183760683760684, "env2_in_acc": 0.750748502994012, "env2_out_acc": 0.7155688622754491, "env3_in_acc": 0.25699745547073793, "env3_out_acc": 0.24076433121019108, "epoch": 35.92814371257485, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -59.33020267367363, "mem_gb": 8.139023303985596, "nll": 2.3291109520196915, "penalty": -0.6165931369317695, "step": 1500, "step_time": 0.0942860468228658}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.4612568639414277, "env0_out_acc": 0.5061124694376528, "env1_in_acc": 0.8448827292110874, "env1_out_acc": 0.8055555555555556, "env2_in_acc": 0.5179640718562875, "env2_out_acc": 0.5179640718562875, "env3_in_acc": 0.2544529262086514, "env3_out_acc": 0.23439490445859873, "epoch": 43.11377245508982, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -36.47712758243084, "mem_gb": 8.139023303985596, "nll": 2.0347538856665293, "penalty": -0.38511881267815623, "step": 1800, "step_time": 0.0943195104598999}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.49725442342892007, "env0_out_acc": 0.5476772616136919, "env1_in_acc": 0.6961620469083155, "env1_out_acc": 0.6346153846153846, "env2_in_acc": 0.5449101796407185, "env2_out_acc": 0.5419161676646707, "env3_in_acc": 0.4688295165394402, "env3_out_acc": 0.46878980891719746, "epoch": 50.29940119760479, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -28.883290398716927, "mem_gb": 8.139023303985596, "nll": 1.9190698512395223, "penalty": -0.3080236003470297, "step": 2100, "step_time": 0.09583010752995809}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.39780353874313606, "env0_out_acc": 0.4547677261613692, "env1_in_acc": 0.5991471215351812, "env1_out_acc": 0.5470085470085471, "env2_in_acc": 0.6002994011976048, "env2_out_acc": 0.5568862275449101, "env3_in_acc": 0.3428753180661578, "env3_out_acc": 0.3668789808917197, "epoch": 57.48502994011976, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -14.417730425198872, "mem_gb": 8.139023303985596, "nll": 2.0186487929026287, "penalty": -0.16436379951114455, "step": 2400, "step_time": 0.09454724709192912}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7126296522269676, "env0_out_acc": 0.7041564792176039, "env1_in_acc": 0.7622601279317697, "env1_out_acc": 0.7136752136752137, "env2_in_acc": 0.8570359281437125, "env2_out_acc": 0.7964071856287425, "env3_in_acc": 0.38231552162849874, "env3_out_acc": 0.3643312101910828, "epoch": 64.67065868263474, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -44.180300297339755, "mem_gb": 8.139023303985596, "nll": 2.2926832441488902, "penalty": -0.4647298366151517, "step": 2700, "step_time": 0.09513766447703044}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7071384990848079, "env0_out_acc": 0.7555012224938875, "env1_in_acc": 0.837953091684435, "env1_out_acc": 0.8183760683760684, "env2_in_acc": 0.8555389221556886, "env2_out_acc": 0.8143712574850299, "env3_in_acc": 0.5314885496183206, "env3_out_acc": 0.5426751592356688, "epoch": 71.8562874251497, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -49.659226362903915, "mem_gb": 8.139023303985596, "nll": 2.1198617829879125, "penalty": -0.5177908840007148, "step": 3000, "step_time": 0.09564589659372966}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.6388041488712629, "env0_out_acc": 0.6650366748166259, "env1_in_acc": 0.8267590618336887, "env1_out_acc": 0.7756410256410257, "env2_in_acc": 0.8278443113772455, "env2_out_acc": 0.7694610778443114, "env3_in_acc": 0.5372137404580153, "env3_out_acc": 0.5554140127388535, "epoch": 79.04191616766467, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -74.29339531580607, "mem_gb": 8.139023303985596, "nll": 2.5307419417301813, "penalty": -0.7682413753968043, "step": 3300, "step_time": 0.0947891632715861}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7547284929835265, "env0_out_acc": 0.7506112469437652, "env1_in_acc": 0.8678038379530917, "env1_out_acc": 0.8205128205128205, "env2_in_acc": 0.8488023952095808, "env2_out_acc": 0.8083832335329342, "env3_in_acc": 0.6491730279898219, "env3_out_acc": 0.664968152866242, "epoch": 86.22754491017965, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -95.51503682772318, "mem_gb": 8.139023303985596, "nll": 2.7619042652845383, "penalty": -0.9827694205194711, "step": 3600, "step_time": 0.09518696864446004}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.75045759609518, "env0_out_acc": 0.7603911980440098, "env1_in_acc": 0.8336886993603412, "env1_out_acc": 0.8076923076923077, "env2_in_acc": 0.8697604790419161, "env2_out_acc": 0.8173652694610778, "env3_in_acc": 0.5524809160305344, "env3_out_acc": 0.5668789808917197, "epoch": 93.41317365269461, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -70.30653072039286, "mem_gb": 8.139023303985596, "nll": 2.6472421870628993, "penalty": -0.7295377526928981, "step": 3900, "step_time": 0.09502647638320923}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7022574740695546, "env0_out_acc": 0.7090464547677262, "env1_in_acc": 0.8267590618336887, "env1_out_acc": 0.7905982905982906, "env2_in_acc": 0.7252994011976048, "env2_out_acc": 0.6856287425149701, "env3_in_acc": 0.4131679389312977, "env3_out_acc": 0.40382165605095544, "epoch": 100.59880239520957, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -50.12600257913272, "mem_gb": 8.139023303985596, "nll": 2.338359102010727, "penalty": -0.5246436139723907, "step": 4200, "step_time": 0.095438764890035}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.6119585112873703, "env0_out_acc": 0.6039119804400978, "env1_in_acc": 0.7777185501066098, "env1_out_acc": 0.7542735042735043, "env2_in_acc": 0.6953592814371258, "env2_out_acc": 0.6766467065868264, "env3_in_acc": 0.37213740458015265, "env3_out_acc": 0.37452229299363055, "epoch": 107.78443113772455, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -35.001984344323475, "mem_gb": 8.139023303985596, "nll": 2.0799121298392613, "penalty": -0.37081896418705584, "step": 4500, "step_time": 0.0955152940750122}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.6308724832214765, "env0_out_acc": 0.6405867970660146, "env1_in_acc": 0.6050106609808102, "env1_out_acc": 0.5769230769230769, "env2_in_acc": 0.7275449101796407, "env2_out_acc": 0.6586826347305389, "env3_in_acc": 0.2057888040712468, "env3_out_acc": 0.2178343949044586, "epoch": 114.97005988023952, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -2.2075763992468516, "mem_gb": 8.139023303985596, "nll": 1.8208311947186788, "penalty": -0.04028407645115901, "step": 4800, "step_time": 0.09555344502131144}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.5704697986577181, "env0_out_acc": 0.5819070904645477, "env1_in_acc": 0.5831556503198294, "env1_out_acc": 0.5555555555555556, "env2_in_acc": 0.7694610778443114, "env2_out_acc": 0.7005988023952096, "env3_in_acc": 0.31838422391857507, "env3_out_acc": 0.34267515923566877, "epoch": 119.76047904191617, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -49.891240730285645, "mem_gb": 8.139023303985596, "nll": 2.3570684242248534, "penalty": -0.5224830932728947, "step": 5000, "step_time": 0.09506593227386474}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.11226357535082367, "env0_out_acc": 0.11735941320293398, "env1_in_acc": 0.18976545842217485, "env1_out_acc": 0.21794871794871795, "env2_in_acc": 0.20808383233532934, "env2_out_acc": 0.20958083832335328, "env3_in_acc": 0.089058524173028, "env3_out_acc": 0.1070063694267516, "epoch": 0.0, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 1.982375144958496, "mem_gb": 7.932544231414795, "nll": 1.9803798198699951, "penalty": 0.001995373982936144, "step": 0, "step_time": 0.36319613456726074}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9890176937156803, "env0_out_acc": 0.9633251833740831, "env1_in_acc": 0.9888059701492538, "env1_out_acc": 0.9572649572649573, "env2_in_acc": 0.999251497005988, "env2_out_acc": 0.9910179640718563, "env3_in_acc": 0.7283715012722646, "env3_out_acc": 0.7464968152866241, "epoch": 7.18562874251497, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.27152745009710394, "mem_gb": 8.137436389923096, "nll": 0.25005287628620865, "penalty": 0.021474574324577892, "step": 300, "step_time": 0.0942247231801351}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9945088468578401, "env0_out_acc": 0.9437652811735942, "env1_in_acc": 0.9957356076759062, "env1_out_acc": 0.9444444444444444, "env2_in_acc": 0.999251497005988, "env2_out_acc": 0.9700598802395209, "env3_in_acc": 0.7258269720101781, "env3_out_acc": 0.7452229299363057, "epoch": 14.37125748502994, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.028411063482053578, "mem_gb": 8.137436389923096, "nll": 0.027953353497820597, "penalty": 0.00045771002760981597, "step": 600, "step_time": 0.09576964775721232}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9981696156192801, "env0_out_acc": 0.9486552567237164, "env1_in_acc": 0.997867803837953, "env1_out_acc": 0.9551282051282052, "env2_in_acc": 1.0, "env2_out_acc": 0.9790419161676647, "env3_in_acc": 0.7627226463104325, "env3_out_acc": 0.7643312101910829, "epoch": 21.55688622754491, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.019534182924350413, "mem_gb": 8.137436389923096, "nll": 0.01938193607396291, "penalty": 0.00015224688794762169, "step": 900, "step_time": 0.09560855388641358}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.99633923123856, "env0_out_acc": 0.9462102689486552, "env1_in_acc": 0.997867803837953, "env1_out_acc": 0.9722222222222222, "env2_in_acc": 0.9985029940119761, "env2_out_acc": 0.9820359281437125, "env3_in_acc": 0.7350508905852418, "env3_out_acc": 0.7541401273885351, "epoch": 28.74251497005988, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.013581927458678061, "mem_gb": 8.137436389923096, "nll": 0.013559841759464083, "penalty": 2.208571423276832e-05, "step": 1200, "step_time": 0.09516089757283529}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9951189749847468, "env0_out_acc": 0.9462102689486552, "env1_in_acc": 0.9989339019189766, "env1_out_acc": 0.9594017094017094, "env2_in_acc": 0.9977544910179641, "env2_out_acc": 0.9760479041916168, "env3_in_acc": 0.7856234096692112, "env3_out_acc": 0.7961783439490446, "epoch": 35.92814371257485, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.012054829776946765, "mem_gb": 8.137436389923096, "nll": 0.012020788684215708, "penalty": 3.404109185718577e-05, "step": 1500, "step_time": 0.0949381136894226}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9993898718730934, "env0_out_acc": 0.9388753056234719, "env1_in_acc": 0.9989339019189766, "env1_out_acc": 0.967948717948718, "env2_in_acc": 1.0, "env2_out_acc": 0.9850299401197605, "env3_in_acc": 0.8311068702290076, "env3_out_acc": 0.8407643312101911, "epoch": 43.11377245508982, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.00951367343882642, "mem_gb": 8.137436389923096, "nll": 0.009390992425226917, "penalty": 0.00012268099889752192, "step": 1800, "step_time": 0.09534340540568034}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.949359365466748, "env0_out_acc": 0.8875305623471883, "env1_in_acc": 0.990405117270789, "env1_out_acc": 0.9508547008547008, "env2_in_acc": 0.9827844311377245, "env2_out_acc": 0.937125748502994, "env3_in_acc": 0.6800254452926209, "env3_out_acc": 0.7210191082802547, "epoch": 50.29940119760479, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.14670563301120032, "mem_gb": 8.139023303985596, "nll": 0.033359148109157105, "penalty": 0.00120961996660526, "step": 2100, "step_time": 0.09565225680669148}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7718120805369127, "env0_out_acc": 0.7457212713936431, "env1_in_acc": 0.753731343283582, "env1_out_acc": 0.7243589743589743, "env2_in_acc": 0.8211077844311377, "env2_out_acc": 0.8083832335329342, "env3_in_acc": 0.5473918575063613, "env3_out_acc": 0.5452229299363057, "epoch": 57.48502994011976, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -0.19010068355749052, "mem_gb": 8.139023303985596, "nll": 0.5042795020900667, "penalty": -0.0069438021610706835, "step": 2400, "step_time": 0.09496804078420003}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.8773642464917633, "env0_out_acc": 0.8581907090464548, "env1_in_acc": 0.8528784648187633, "env1_out_acc": 0.8226495726495726, "env2_in_acc": 0.9468562874251497, "env2_out_acc": 0.9281437125748503, "env3_in_acc": 0.5365776081424937, "env3_out_acc": 0.554140127388535, "epoch": 64.67065868263474, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -54.52420285820961, "mem_gb": 8.139023303985596, "nll": 2.1271682808796566, "penalty": -0.5665137101702081, "step": 2700, "step_time": 0.09486278057098389}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.8047589993898718, "env0_out_acc": 0.7897310513447433, "env1_in_acc": 0.8560767590618337, "env1_out_acc": 0.8376068376068376, "env2_in_acc": 0.8869760479041916, "env2_out_acc": 0.8203592814371258, "env3_in_acc": 0.6561704834605598, "env3_out_acc": 0.7019108280254777, "epoch": 71.8562874251497, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -50.214801118771234, "mem_gb": 8.139023303985596, "nll": 2.199207166234652, "penalty": -0.5241400797548704, "step": 3000, "step_time": 0.09495402812957764}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.5771812080536913, "env0_out_acc": 0.58679706601467, "env1_in_acc": 0.7126865671641791, "env1_out_acc": 0.7222222222222222, "env2_in_acc": 0.8031437125748503, "env2_out_acc": 0.8023952095808383, "env3_in_acc": 0.32251908396946566, "env3_out_acc": 0.32229299363057323, "epoch": 79.04191616766467, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -11.193957778016726, "mem_gb": 8.139023303985596, "nll": 2.001456047296524, "penalty": -0.1319541400166539, "step": 3300, "step_time": 0.09502718210220337}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.6333129957291032, "env0_out_acc": 0.6185819070904646, "env1_in_acc": 0.720682302771855, "env1_out_acc": 0.6837606837606838, "env2_in_acc": 0.8106287425149701, "env2_out_acc": 0.7604790419161677, "env3_in_acc": 0.42302798982188294, "env3_out_acc": 0.4050955414012739, "epoch": 86.22754491017965, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -46.97267183581988, "mem_gb": 8.139023303985596, "nll": 2.2894428797562916, "penalty": -0.4926211432988445, "step": 3600, "step_time": 0.09514250675837199}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7669310555216595, "env0_out_acc": 0.7579462102689487, "env1_in_acc": 0.761727078891258, "env1_out_acc": 0.7863247863247863, "env2_in_acc": 0.9281437125748503, "env2_out_acc": 0.8862275449101796, "env3_in_acc": 0.4042620865139949, "env3_out_acc": 0.40254777070063696, "epoch": 93.41317365269461, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -114.17925692399344, "mem_gb": 8.139023303985596, "nll": 2.8313845479488373, "penalty": -1.1701064192526973, "step": 3900, "step_time": 0.09464169422785441}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.5930445393532642, "env0_out_acc": 0.5990220048899756, "env1_in_acc": 0.8038379530916845, "env1_out_acc": 0.7713675213675214, "env2_in_acc": 0.8001497005988024, "env2_out_acc": 0.7694610778443114, "env3_in_acc": 0.2674936386768448, "env3_out_acc": 0.2445859872611465, "epoch": 100.59880239520957, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -42.039410806099575, "mem_gb": 8.139023303985596, "nll": 2.2505862764517466, "penalty": -0.4428999713544423, "step": 4200, "step_time": 0.09487129052480062}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7699816961561928, "env0_out_acc": 0.7432762836185819, "env1_in_acc": 0.7585287846481876, "env1_out_acc": 0.7307692307692307, "env2_in_acc": 0.9161676646706587, "env2_out_acc": 0.8832335329341318, "env3_in_acc": 0.48950381679389315, "env3_out_acc": 0.4713375796178344, "epoch": 107.78443113772455, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -96.86889513810476, "mem_gb": 8.139023303985596, "nll": 2.616754208604495, "penalty": -0.9948564911261201, "step": 4500, "step_time": 0.09534992059071859}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.4777303233679073, "env0_out_acc": 0.511002444987775, "env1_in_acc": 0.6924307036247335, "env1_out_acc": 0.6965811965811965, "env2_in_acc": 0.5838323353293413, "env2_out_acc": 0.5808383233532934, "env3_in_acc": 0.17557251908396945, "env3_out_acc": 0.17452229299363056, "epoch": 114.97005988023952, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -139.86155326565105, "mem_gb": 8.139023303985596, "nll": 3.4751881889502205, "penalty": -1.4333673981654769, "step": 4800, "step_time": 0.09480790774027506}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 2000}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.6119585112873703, "env0_out_acc": 0.6210268948655256, "env1_in_acc": 0.7062899786780383, "env1_out_acc": 0.6688034188034188, "env2_in_acc": 0.8652694610778443, "env2_out_acc": 0.7964071856287425, "env3_in_acc": 0.26908396946564883, "env3_out_acc": 0.26496815286624203, "epoch": 119.76047904191617, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 2000, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -55.74241711169481, "mem_gb": 8.139023303985596, "nll": 2.469253556728363, "penalty": -0.5821167048886128, "step": 5000, "step_time": 0.09478403925895691}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.11226357535082367, "env0_out_acc": 0.11735941320293398, "env1_in_acc": 0.18976545842217485, "env1_out_acc": 0.21794871794871795, "env2_in_acc": 0.20808383233532934, "env2_out_acc": 0.20958083832335328, "env3_in_acc": 0.089058524173028, "env3_out_acc": 0.1070063694267516, "epoch": 0.0, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 1.982375144958496, "mem_gb": 7.932544231414795, "nll": 1.9803798198699951, "penalty": 0.001995373982936144, "step": 0, "step_time": 0.3627316951751709}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.9890176937156803, "env0_out_acc": 0.9633251833740831, "env1_in_acc": 0.9888059701492538, "env1_out_acc": 0.9572649572649573, "env2_in_acc": 0.999251497005988, "env2_out_acc": 0.9910179640718563, "env3_in_acc": 0.7283715012722646, "env3_out_acc": 0.7464968152866241, "epoch": 7.18562874251497, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.27152745009710394, "mem_gb": 8.137436389923096, "nll": 0.25005287628620865, "penalty": 0.021474574324577892, "step": 300, "step_time": 0.0941438094774882}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.8364856619890177, "env0_out_acc": 0.8019559902200489, "env1_in_acc": 0.7995735607675906, "env1_out_acc": 0.7606837606837606, "env2_in_acc": 0.937125748502994, "env2_out_acc": 0.9041916167664671, "env3_in_acc": 0.6103689567430025, "env3_out_acc": 0.6012738853503184, "epoch": 14.37125748502994, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": 0.4529195653491964, "mem_gb": 8.139023303985596, "nll": 0.08229016776041438, "penalty": 0.004163120598550449, "step": 600, "step_time": 0.09363705396652222}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7211714460036608, "env0_out_acc": 0.726161369193154, "env1_in_acc": 0.7910447761194029, "env1_out_acc": 0.7884615384615384, "env2_in_acc": 0.7986526946107785, "env2_out_acc": 0.7305389221556886, "env3_in_acc": 0.6332697201017812, "env3_out_acc": 0.643312101910828, "epoch": 21.55688622754491, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -13.96678027878205, "mem_gb": 8.139023303985596, "nll": 1.418085314631462, "penalty": -0.15384865674631631, "step": 900, "step_time": 0.09406700452168783}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.5216595485051861, "env0_out_acc": 0.5501222493887531, "env1_in_acc": 0.8363539445628998, "env1_out_acc": 0.8012820512820513, "env2_in_acc": 0.47380239520958084, "env2_out_acc": 0.5, "env3_in_acc": 0.48759541984732824, "env3_out_acc": 0.45222929936305734, "epoch": 28.74251497005988, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -56.683046867847445, "mem_gb": 8.139023303985596, "nll": 2.247739404439926, "penalty": -0.5893078695941949, "step": 1200, "step_time": 0.09402718464533488}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.5454545454545454, "env0_out_acc": 0.5745721271393643, "env1_in_acc": 0.8256929637526652, "env1_out_acc": 0.8183760683760684, "env2_in_acc": 0.750748502994012, "env2_out_acc": 0.7155688622754491, "env3_in_acc": 0.25699745547073793, "env3_out_acc": 0.24076433121019108, "epoch": 35.92814371257485, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -59.33020267367363, "mem_gb": 8.139023303985596, "nll": 2.3291109520196915, "penalty": -0.6165931369317695, "step": 1500, "step_time": 0.09402039130528768}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.4612568639414277, "env0_out_acc": 0.5061124694376528, "env1_in_acc": 0.8448827292110874, "env1_out_acc": 0.8055555555555556, "env2_in_acc": 0.5179640718562875, "env2_out_acc": 0.5179640718562875, "env3_in_acc": 0.2544529262086514, "env3_out_acc": 0.23439490445859873, "epoch": 43.11377245508982, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -36.47712758243084, "mem_gb": 8.139023303985596, "nll": 2.0347538856665293, "penalty": -0.38511881267815623, "step": 1800, "step_time": 0.0960043454170227}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.49725442342892007, "env0_out_acc": 0.5476772616136919, "env1_in_acc": 0.6961620469083155, "env1_out_acc": 0.6346153846153846, "env2_in_acc": 0.5449101796407185, "env2_out_acc": 0.5419161676646707, "env3_in_acc": 0.4688295165394402, "env3_out_acc": 0.46878980891719746, "epoch": 50.29940119760479, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -28.883290398716927, "mem_gb": 8.139023303985596, "nll": 1.9190698512395223, "penalty": -0.3080236003470297, "step": 2100, "step_time": 0.09461154301961262}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.39780353874313606, "env0_out_acc": 0.4547677261613692, "env1_in_acc": 0.5991471215351812, "env1_out_acc": 0.5470085470085471, "env2_in_acc": 0.6002994011976048, "env2_out_acc": 0.5568862275449101, "env3_in_acc": 0.3428753180661578, "env3_out_acc": 0.3668789808917197, "epoch": 57.48502994011976, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -14.417730425198872, "mem_gb": 8.139023303985596, "nll": 2.0186487929026287, "penalty": -0.16436379951114455, "step": 2400, "step_time": 0.094373726050059}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7126296522269676, "env0_out_acc": 0.7041564792176039, "env1_in_acc": 0.7622601279317697, "env1_out_acc": 0.7136752136752137, "env2_in_acc": 0.8570359281437125, "env2_out_acc": 0.7964071856287425, "env3_in_acc": 0.38231552162849874, "env3_out_acc": 0.3643312101910828, "epoch": 64.67065868263474, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -44.180300297339755, "mem_gb": 8.139023303985596, "nll": 2.2926832441488902, "penalty": -0.4647298366151517, "step": 2700, "step_time": 0.09584789037704468}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7071384990848079, "env0_out_acc": 0.7555012224938875, "env1_in_acc": 0.837953091684435, "env1_out_acc": 0.8183760683760684, "env2_in_acc": 0.8555389221556886, "env2_out_acc": 0.8143712574850299, "env3_in_acc": 0.5314885496183206, "env3_out_acc": 0.5426751592356688, "epoch": 71.8562874251497, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -49.659226362903915, "mem_gb": 8.139023303985596, "nll": 2.1198617829879125, "penalty": -0.5177908840007148, "step": 3000, "step_time": 0.09536715745925903}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.6388041488712629, "env0_out_acc": 0.6650366748166259, "env1_in_acc": 0.8267590618336887, "env1_out_acc": 0.7756410256410257, "env2_in_acc": 0.8278443113772455, "env2_out_acc": 0.7694610778443114, "env3_in_acc": 0.5372137404580153, "env3_out_acc": 0.5554140127388535, "epoch": 79.04191616766467, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -74.29339531580607, "mem_gb": 8.139023303985596, "nll": 2.5307419417301813, "penalty": -0.7682413753968043, "step": 3300, "step_time": 0.09495520909627278}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7547284929835265, "env0_out_acc": 0.7506112469437652, "env1_in_acc": 0.8678038379530917, "env1_out_acc": 0.8205128205128205, "env2_in_acc": 0.8488023952095808, "env2_out_acc": 0.8083832335329342, "env3_in_acc": 0.6491730279898219, "env3_out_acc": 0.664968152866242, "epoch": 86.22754491017965, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -95.51503682772318, "mem_gb": 8.139023303985596, "nll": 2.7619042652845383, "penalty": -0.9827694205194711, "step": 3600, "step_time": 0.09485907157262166}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.75045759609518, "env0_out_acc": 0.7603911980440098, "env1_in_acc": 0.8336886993603412, "env1_out_acc": 0.8076923076923077, "env2_in_acc": 0.8697604790419161, "env2_out_acc": 0.8173652694610778, "env3_in_acc": 0.5524809160305344, "env3_out_acc": 0.5668789808917197, "epoch": 93.41317365269461, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -70.30653072039286, "mem_gb": 8.139023303985596, "nll": 2.6472421870628993, "penalty": -0.7295377526928981, "step": 3900, "step_time": 0.0951091456413269}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.7022574740695546, "env0_out_acc": 0.7090464547677262, "env1_in_acc": 0.8267590618336887, "env1_out_acc": 0.7905982905982906, "env2_in_acc": 0.7252994011976048, "env2_out_acc": 0.6856287425149701, "env3_in_acc": 0.4131679389312977, "env3_out_acc": 0.40382165605095544, "epoch": 100.59880239520957, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -50.12600257913272, "mem_gb": 8.139023303985596, "nll": 2.338359102010727, "penalty": -0.5246436139723907, "step": 4200, "step_time": 0.0956722116470337}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.6119585112873703, "env0_out_acc": 0.6039119804400978, "env1_in_acc": 0.7777185501066098, "env1_out_acc": 0.7542735042735043, "env2_in_acc": 0.6953592814371258, "env2_out_acc": 0.6766467065868264, "env3_in_acc": 0.37213740458015265, "env3_out_acc": 0.37452229299363055, "epoch": 107.78443113772455, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -35.001984344323475, "mem_gb": 8.139023303985596, "nll": 2.0799121298392613, "penalty": -0.37081896418705584, "step": 4500, "step_time": 0.09563714583714802}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.6308724832214765, "env0_out_acc": 0.6405867970660146, "env1_in_acc": 0.6050106609808102, "env1_out_acc": 0.5769230769230769, "env2_in_acc": 0.7275449101796407, "env2_out_acc": 0.6586826347305389, "env3_in_acc": 0.2057888040712468, "env3_out_acc": 0.2178343949044586, "epoch": 114.97005988023952, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -2.2075763992468516, "mem_gb": 8.139023303985596, "nll": 1.8208311947186788, "penalty": -0.04028407645115901, "step": 4800, "step_time": 0.0959791350364685}
{"args": {"algorithm": "IRM", "checkpoint_freq": null, "data_dir": "./data/", "dataset": "PACS", "holdout_fraction": 0.2, "hparams": "{\"progress_bar\": true, \"irm_lambda\": 100, \"irm_penalty_anneal_iters\": 500}", "hparams_seed": 0, "output_dir": "./results/irm_weak_penalty", "save_model_every_checkpoint": false, "seed": 0, "skip_model_save": false, "steps": null, "task": "domain_generalization", "test_envs": [3], "trial_seed": 0, "uda_holdout_fraction": 0}, "env0_in_acc": 0.5704697986577181, "env0_out_acc": 0.5819070904645477, "env1_in_acc": 0.5831556503198294, "env1_out_acc": 0.5555555555555556, "env2_in_acc": 0.7694610778443114, "env2_out_acc": 0.7005988023952096, "env3_in_acc": 0.31838422391857507, "env3_out_acc": 0.34267515923566877, "epoch": 119.76047904191617, "hparams": {"batch_size": 32, "class_balanced": false, "data_augmentation": true, "dinov2": false, "freeze_bn": false, "irm_lambda": 100, "irm_penalty_anneal_iters": 500, "lars": false, "linear_steps": 500, "lr": 5e-05, "nonlinear_classifier": false, "progress_bar": true, "resnet18": false, "resnet50_augmix": true, "resnet_dropout": 0.0, "vit": false, "vit_attn_tune": false, "vit_dropout": 0.0, "weight_decay": 0.0}, "loss": -49.891240730285645, "mem_gb": 8.139023303985596, "nll": 2.3570684242248534, "penalty": -0.5224830932728947, "step": 5000, "step_time": 0.09596418619155883}
